# YOLO Детектор аэрозолей и алюминиевых банок

Проект для обучения и использования YOLO модели для детекции аэрозолей и алюминиевых банок.

## Структура проекта

```
проект/
├── data.yaml                 # Конфигурация dataset
├── train/                   # Обучающие данные
│   ├── images/             # Изображения
│   └── labels/             # YOLO аннотации
├── train_model.py          # Скрипт обучения модели
├── inference.py            # Скрипт для предсказаний
├── dataset_utils.py        # Утилиты для анализа данных
├── requirements.txt        # Зависимости
└── README.md              # Этот файл
```

## Установка

1. Убедитесь, что у вас установлен Python 3.8+

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### 1. Анализ dataset

Перед обучением рекомендуется проанализировать ваши данные:

```bash
pip install -r requirements.txt
```

Этот скрипт покажет:
- Количество изображений в каждом split
- Распределение классов
- Статистики по размерам изображений
- Примеры изображений с аннотациями

### 2. Обучение модели

```bash
python train_model.py
```

Параметры обучения можно настроить в файле `train_model.py`:
- `epochs`: количество эпох (по умолчанию 100)
- `batch`: размер батча (по умолчанию 16)
- `imgsz`: размер изображения (по умолчанию 640)
- Модель: можно выбрать yolov8n.pt, yolov8s.pt, yolov8m.pt, yolov8l.pt, yolov8x.pt

### 3. Использование модели для предсказаний

```bash
python inference.py
```

Интерактивное меню позволяет:
1. Предсказание на изображении
2. Предсказание на видео
3. Реальное время с веб-камеры

### Примеры использования в коде

```python
from ultralytics import YOLO

# Загрузка обученной модели
model = YOLO('runs/detect/aerosols_cans_detection/weights/best.pt')

# Предсказание на изображении
results = model('path/to/image.jpg')

# Предсказание на видео
results = model('path/to/video.mp4')

# Предсказание с веб-камеры
results = model(0)  # 0 = default camera
```

## Классы для детекции

- `aerosols` (ID: 0) - Аэрозоли
- `aluminum_food_cans` (ID: 1) - Алюминиевые банки

## Результаты обучения

После обучения результаты будут сохранены в папке `runs/detect/aerosols_cans_detection/`:
- `weights/best.pt` - лучшая модель
- `weights/last.pt` - последняя модель  
- `results.png` - графики обучения
- `confusion_matrix.png` - матрица ошибок
- `val_batch*.jpg` - примеры предсказаний на validation

## Настройка параметров

### data.yaml
Основной конфигурационный файл содержит:
- Пути к train/val/test данным
- Количество классов (nc)
- Названия классов (names)

### Параметры обучения
В `train_model.py` можно настроить:
- Архитектуру модели (nano, small, medium, large, xlarge)
- Количество эпох
- Размер батча
- Размер изображений
- Параметры аугментации

### Параметры инференса
В `inference.py` можно настроить:
- Порог уверенности (confidence threshold)
- Порог IoU для NMS
- Размер изображения для инференса

## Требования к системе

- Python 3.8+
- CUDA (опционально, для GPU ускорения)
- Минимум 8GB RAM
- Для обучения: минимум 4GB GPU памяти (рекомендуется)

## Поддерживаемые форматы

### Изображения
- JPG, JPEG
- PNG
- BMP
- TIFF

### Видео
- MP4
- AVI
- MOV
- MKV

## Советы по улучшению качества

1. **Увеличение dataset**: Добавьте больше разнообразных изображений
2. **Аугментация**: Используйте различные трансформации изображений
3. **Балансировка классов**: Убедитесь в равномерном распределении классов
4. **Качество аннотаций**: Проверьте точность разметки
5. **Гиперпараметры**: Экспериментируйте с learning rate, batch size, etc.

## Устранение проблем

### Ошибки памяти
- Уменьшите batch size
- Уменьшите размер изображения (imgsz)
- Используйте более легкую модель (yolov8n вместо yolov8l)

### Низкое качество детекции
- Увеличьте количество эпох обучения
- Проверьте качество аннотаций
- Добавьте больше данных
- Настройте порог уверенности

### Медленный инференс  
- Используйте GPU
- Уменьшите размер изображения
- Используйте более легкую модель

## Лицензия

MIT License - см. файл LICENSE для деталей.

## Контакты

Если у вас есть вопросы или предложения, создайте issue в репозитории.